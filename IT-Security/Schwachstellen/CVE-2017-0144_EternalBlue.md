#  CVE-2017-0144 - EternalBlue

EternalBlue ist ein Exploit zur Ausnutzung der Schwachstellen CVE-2017-0143, CVE-2017-0144 (Hauptschwachstelle), CVE-2017-0145, CVE-2017-0146, CVE-2017-0147 und CVE-2017-0148  in der Implementierung des Server Message Block (SMB) Protokolls Servers in version SMBv1 der Betriebssyteme

* Microsoft Windows Vista SP2
* Windows Server 2008 SP2 and R2 SP1
* Windows 7 SP1
* Windows 8.1
* Windows Server 2012 Gold and R2
* Windows RT 8.1
* Windows 10 Gold, 1511, and 1607
* Windows Server 2016
* Windows XP
* Windows 8
* Windows Server 2003

Um die Schwachstelle auszunutzen genügt es in den meisten Fällen, dass ein unauthentifizierter Angreifer speziell gestaltete Pakete an den Ziel SMBv1 Server sendet. Der SMBv1 Server geht durch die Schwachstelle falsch mit diesen Paketen um, was ein Angreifer der die Lücke erfolgreich ausnutzt dazu missbrauchen kann, eigene Anweisungen / schädlcihen Programmcode auf dem Zielsystem auszuführen. Dies kann unter anderem von wurmartigen Schadsoftwaren verwendet werden um sich weiter im Netzwerk auszubreiten.

Jedoch sind auch andere Betriebssysteme welche SMBv1 implementieren (zum Beispiel der SAMBA Server in entsprechender Version unter Linux Distributionen) für die Schwachstelle anfällig.

Dies führte zudem dazu, dass Microsoft die Installation des Feature SMBv1 unter aktuelleren Windows 10 Versionen standardmäßig nicht mehr installierte.

https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2017-0143
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0144
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0145
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0146
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0147
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0148

## Exploitentwicklung durch die National Security Agency (NSA)

Besondere Brisanz erhält die Offenlegung der Lücke und die schnellen Patches durch Microsoft durch den Hintergrund, dass die National Security Agency der Vereinigten Staaten von Amerika jahrelang die Lücke mit dem Exploit EternalBlue gezielt gegen Ziele einsetzte und lediglich durch den Umstand, dass Sie selbst von einer Hackergruppe infiltriert wurden und unter anderem das EternalBlue Tool "entwendet" wurde, dazu gezwungen wurden, die Lücke an Microsoft zu melden um dem Softwarehersteller die Möglichkeit zu geben, die Lücke zu schließen, bevor andere Akteure ebenfalls diese Lücke ausnutzen konnten.


## Microsoft CVE-2017-0144 | Windows SMB Remote Code Execution Vulnerability - Security Patch (englisch)

https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0144

## Microsoft Security Bulletin MS17-010 (englisch)

https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010

## Weitere interessante Artikel (deutsch und englisch)

https://www.avast.com/c-eternalblue
https://www.cryptron.ch/eternalblue-der-nsa-exploit-zwei-jahre-danach/


## Timeline

* 25 Oktober 2001 - Windows XP - die älteste Version welche über die Lücke(n) angreifbar war - wird veröffentlicht

* 2012 bis 2017 - Laut Internetquellen nutzte die NSA die Lücke mehr als 5 Jahre aktiv aus

* 14 März 2017 - Microsoft veröffentlicht das Security Bulletin MS17-010
* 14 April 2017 - die Hackinggruppe "Shadow Brokers" veröffentlicht den von Ihnen bei der NSA durch einen Hacking-Angriff erbeuteten Exploit EternalBlue
* 12 Mai 2017 - Aufgrund der Angriffe des Erpressungstrojaners "WannaCry" stellte Microsoft auch für nicht mehr unter Support stehende Betriebssystemversionen Windows XP, Windows 8, Windows Server 2003) Patches bereit
* 12 - 15 Mai 2017 - die erste weltweite Welle der WannaCry Ransomware wird verteilt und nutzt die entsprechende Schwachstelle aus
* 27 Juni 2017 - Die Schadsoftware NotPetya nutzt ebenfalls die EternalBlue Schwachstelle zur Verbreitung 
* 20 Mai 2020 - Laut Shodan sind auch 3 Jahre nach Bereitstellung der Patches rund 1 Million Windows Computer weltweit aus dem Internet erreichbar, auf denen der Patch noch nicht installiert wurde ( https://www.welivesecurity.com/deutsch/2020/05/12/3-jahre-wannacryptor-die-bedrohung-bleibt/ )
